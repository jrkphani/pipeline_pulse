<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Stage Filter Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-result { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background-color: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .info { background-color: #d1ecf1; border: 1px solid #bee5eb; color: #0c5460; }
    </style>
</head>
<body>
    <h1>Sales Stage Filter Test</h1>
    <p>Testing the updated Sales Stage filter with 10%-39% probability range</p>
    
    <div id="results"></div>
    
    <script>
        // Simulate the filter configuration
        const PROBABILITY_STAGE_PRESETS = [
            {
                label: "Sales Stage",
                value: "sales-stage",
                minProbability: 10,
                maxProbability: 39,
                description: "Early stage deals requiring sales development",
                color: "#ef4444"
            },
            {
                label: "Presales Stage", 
                value: "presales-stage",
                minProbability: 40,
                maxProbability: 70,
                description: "Active opportunities in technical evaluation",
                color: "#f59e0b"
            }
        ];
        
        // Test data - sample deals with different probabilities
        const testDeals = [
            { id: 1, name: "Deal A", probability: 5 },   // Should NOT be included
            { id: 2, name: "Deal B", probability: 10 },  // Should be included (min)
            { id: 3, name: "Deal C", probability: 25 },  // Should be included (middle)
            { id: 4, name: "Deal D", probability: 39 },  // Should be included (max)
            { id: 5, name: "Deal E", probability: 40 },  // Should NOT be included
            { id: 6, name: "Deal F", probability: 50 }   // Should NOT be included
        ];
        
        function testSalesStageFilter() {
            const results = document.getElementById('results');
            const salesStage = PROBABILITY_STAGE_PRESETS.find(stage => stage.value === 'sales-stage');
            
            results.innerHTML += `<div class="test-result info">
                <strong>Sales Stage Filter Configuration:</strong><br>
                Label: ${salesStage.label}<br>
                Probability Range: ${salesStage.minProbability}% - ${salesStage.maxProbability}%<br>
                Description: ${salesStage.description}
            </div>`;
            
            // Filter deals based on Sales Stage criteria
            const filteredDeals = testDeals.filter(deal => 
                deal.probability >= salesStage.minProbability && 
                deal.probability <= salesStage.maxProbability
            );
            
            results.innerHTML += `<div class="test-result success">
                <strong>Filter Test Results:</strong><br>
                Total test deals: ${testDeals.length}<br>
                Deals matching Sales Stage filter: ${filteredDeals.length}<br><br>
                <strong>Included deals:</strong><br>
                ${filteredDeals.map(deal => `• ${deal.name} (${deal.probability}%)`).join('<br>')}
            </div>`;
            
            // Verify expected results
            const expectedIncluded = [2, 3, 4]; // Deal B, C, D
            const actualIncluded = filteredDeals.map(deal => deal.id);
            const testPassed = JSON.stringify(expectedIncluded) === JSON.stringify(actualIncluded);
            
            results.innerHTML += `<div class="test-result ${testPassed ? 'success' : 'error'}">
                <strong>Validation:</strong><br>
                Expected deals: ${expectedIncluded.join(', ')}<br>
                Actual deals: ${actualIncluded.join(', ')}<br>
                Test result: ${testPassed ? '✅ PASSED' : '❌ FAILED'}
            </div>`;
            
            // Test boundary conditions
            results.innerHTML += `<div class="test-result info">
                <strong>Boundary Condition Tests:</strong><br>
                • Deal with 9% probability: ${9 >= salesStage.minProbability && 9 <= salesStage.maxProbability ? 'Included' : 'Excluded'} ✓<br>
                • Deal with 10% probability: ${10 >= salesStage.minProbability && 10 <= salesStage.maxProbability ? 'Included' : 'Excluded'} ✓<br>
                • Deal with 39% probability: ${39 >= salesStage.minProbability && 39 <= salesStage.maxProbability ? 'Included' : 'Excluded'} ✓<br>
                • Deal with 40% probability: ${40 >= salesStage.minProbability && 40 <= salesStage.maxProbability ? 'Included' : 'Excluded'} ✓
            </div>`;
        }
        
        // Run test when page loads
        window.addEventListener('load', testSalesStageFilter);
    </script>
</body>
</html>
